<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>智能文档助手 - 登录</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f4f7f6; height: 100vh; display: flex; align-items: center; justify-content: center; }
    .auth-card { width: 100%; max-width: 400px; padding: 2rem; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); background: white; }
  </style>
</head>
<body>
<div class="auth-card">
  <h3 class="text-center mb-4" id="formTitle">欢迎回来</h3>
  <form id="authForm">
    <div class="mb-3">
      <label class="form-label">用户名</label>
      <input type="text" class="form-control" id="username" required>
    </div>
    <div class="mb-3">
      <label class="form-label">密码</label>
      <input type="password" class="form-control" id="password" required>
    </div>
    <div id="registerFields" class="d-none">
      <div class="mb-3">
        <label class="form-label">手机号</label>
        <input type="text" class="form-control" id="phone">
      </div>
      <div class="mb-3">
        <label class="form-label">邮箱</label>
        <input type="email" class="form-control" id="email">
      </div>
    </div>
    <button type="submit" class="btn btn-primary w-100" id="submitBtn">登录</button>
    <div class="text-center mt-3">
      <a href="#" id="toggleMode" style="font-size: 14px; text-decoration: none;">没有账号？立即注册</a>
    </div>
  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="js/main.js"></script>
<script>
  let isLogin = true;
  const toggleBtn = document.getElementById('toggleMode');
  const regFields = document.getElementById('registerFields');
  const formTitle = document.getElementById('formTitle');
  const submitBtn = document.getElementById('submitBtn');

  toggleBtn.onclick = (e) => {
    e.preventDefault();
    isLogin = !isLogin;
    formTitle.innerText = isLogin ? "欢迎回来" : "创建账号";
    submitBtn.innerText = isLogin ? "登录" : "注册";
    toggleBtn.innerText = isLogin ? "没有账号？立即注册" : "已有账号？去登录";
    regFields.classList.toggle('d-none');
  };

  document.getElementById('authForm').onsubmit = async (e) => {
    e.preventDefault();
    const u = document.getElementById('username').value;
    const p = document.getElementById('password').value;
    if (isLogin) {
      await login(u, p);
    } else {
      const phone = document.getElementById('phone').value;
      const email = document.getElementById('email').value;
      await register(u, p, 'USER', phone, email);
    }
  };
</script>
</body>
</html>

<!--<!DOCTYPE html>-->
<!--<html lang="zh-CN">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>智能文档平台 - 登录</title>-->
<!--  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--  <style>-->
<!--    body { background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; height: 100vh; }-->
<!--    .card { width: 100%; max-width: 400px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->

<!--<div class="card">-->
<!--  <h3 class="text-center mb-4" id="formTitle">用户登录</h3>-->

<!--  <form id="authForm">-->
<!--    <div class="mb-3">-->
<!--      <label class="form-label">用户名</label>-->
<!--      <input type="text" class="form-control" id="username" required minlength="2">-->
<!--    </div>-->
<!--    <div class="mb-3">-->
<!--      <label class="form-label">密码</label>-->
<!--      <input type="password" class="form-control" id="password" required minlength="6">-->
<!--    </div>-->

<!--    <div class="mb-3 d-none" id="registerFields">-->
<!--      <label class="form-label">确认密码</label>-->
<!--      <input type="password" class="form-control" id="confirmPassword" required>-->

<!--      <label class="form-label mt-2">电话 (**必填**)</label>-->
<!--      <input type="tel" class="form-control" id="phone" placeholder="请输入11位电话号码" required>-->

<!--      <label class="form-label mt-2">邮箱 (**必填**)</label>-->
<!--      <input type="email" class="form-control" id="email" placeholder="test@example.com" required>-->

<!--      <label class="form-label mt-2">角色</label>-->
<!--      <select class="form-select" id="role">-->
<!--        <option value="USERS">普通用户</option>-->
<!--        <option value="ADMIN">管理员</option>-->
<!--      </select>-->
<!--    </div>-->

<!--    <button type="submit" class="btn btn-primary w-100" id="submitBtn">登录</button>-->
<!--  </form>-->

<!--  <div class="mt-3 text-center">-->
<!--    <a href="#" id="toggleMode">没有账号？去注册</a>-->
<!--  </div>-->
<!--</div>-->


<!--<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>-->
<!--<script src="js/main.js"></script>-->
<!--<script>-->
<!--  let isLoginMode = true;-->
<!--  const toggleBtn = document.getElementById('toggleMode');-->
<!--  const formTitle = document.getElementById('formTitle');-->
<!--  const submitBtn = document.getElementById('submitBtn');-->
<!--  const registerFields = document.getElementById('registerFields');-->

<!--  // 获取所有需要管理的字段-->
<!--  const phoneInput = document.getElementById('phone');-->
<!--  const emailInput = document.getElementById('email');-->
<!--  const confirmPasswordInput = document.getElementById('confirmPassword');-->

<!--  // 统一处理模式切换的函数-->
<!--  function setMode(isLogin) {-->
<!--    isLoginMode = isLogin;-->

<!--    if (isLogin) {-->
<!--      // 切换到登录模式-->
<!--      formTitle.innerText = "用户登录";-->
<!--      submitBtn.innerText = "登录";-->
<!--      toggleBtn.innerText = "没有账号？去注册";-->
<!--      registerFields.classList.add('d-none');-->

<!--      // 【核心修复】登录模式下，移除必填属性，避免干扰-->
<!--      phoneInput.removeAttribute('required');-->
<!--      emailInput.removeAttribute('required');-->
<!--      confirmPasswordInput.removeAttribute('required');-->

<!--    } else {-->
<!--      // 切换到注册模式-->
<!--      formTitle.innerText = "用户注册";-->
<!--      submitBtn.innerText = "注册";-->
<!--      toggleBtn.innerText = "已有账号？去登录";-->
<!--      registerFields.classList.remove('d-none');-->

<!--      // 【核心修复】注册模式下，确保必填属性存在-->
<!--      phoneInput.setAttribute('required', 'required');-->
<!--      emailInput.setAttribute('required', 'required');-->
<!--      confirmPasswordInput.setAttribute('required', 'required');-->
<!--    }-->
<!--  }-->

<!--  // 页面初始化时，确保处于登录模式且属性正确-->
<!--  setMode(true);-->

<!--  toggleBtn.addEventListener('click', (e) => {-->
<!--    e.preventDefault();-->
<!--    setMode(!isLoginMode);-->
<!--  });-->

<!--  document.getElementById('authForm').addEventListener('submit', async (e) => {-->
<!--    e.preventDefault();-->
<!--    const username = document.getElementById('username').value;-->
<!--    const password = document.getElementById('password').value;-->

<!--    if (isLoginMode) {-->
<!--      await login(username, password);-->
<!--    } else {-->
<!--      // 注册逻辑（与之前保持一致）-->
<!--      const role = document.getElementById('role').value;-->
<!--      const phone = phoneInput.value;-->
<!--      const email = emailInput.value;-->
<!--      const confirmPassword = confirmPasswordInput.value;-->

<!--      if (password !== confirmPassword) {-->
<!--        alert('两次输入的密码不一致！');-->
<!--        return;-->
<!--      }-->

<!--      const phoneRegex = /^1[3-9]\d{9}$/;-->
<!--      if (!phoneRegex.test(phone)) {-->
<!--        alert('电话号码格式不正确，请输入11位手机号！');-->
<!--        return;-->
<!--      }-->

<!--      await register(username, password, role, phone, email);-->
<!--    }-->
<!--  });-->
<!--</script>-->