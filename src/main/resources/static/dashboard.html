<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>AI æ™ºèƒ½æ–‡æ¡£æ§åˆ¶å°</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    :root { --sidebar-bg: #171717; --active-gray: #2f2f2f; }
    body { background-color: #fff; height: 100vh; overflow: hidden; display: flex; }

    /* ä¾§è¾¹æ  */
    #sidebar { width: 260px; background: var(--sidebar-bg); color: #ececec; display: flex; flex-direction: column; }
    .sidebar-btn { margin: 10px; border: 1px solid #4d4d4d; color: #fff; border-radius: 6px; padding: 10px; text-align: left; background: transparent; transition: 0.2s; }
    .sidebar-btn:hover { background: var(--active-gray); }
    .nav-link-custom { padding: 10px 20px; color: #c5c5d2; cursor: pointer; display: flex; align-items: center; font-size: 14px; }
    .nav-link-custom:hover, .nav-link-custom.active { background: var(--active-gray); color: #fff; }
    .session-list { flex-grow: 1; overflow-y: auto; }

    /* ä¸»åŒºåŸŸ */
    #main { flex-grow: 1; display: flex; flex-direction: column; position: relative; }
    .section { display: none; height: 100%; flex-direction: column; padding: 20px 40px; overflow-y: auto; }
    .section.active { display: flex; }

    /* èŠå¤©æ°”æ³¡ */
    #message-area { flex-grow: 1; overflow-y: auto; padding: 20px 10% 120px 10%; }
    .msg-row { display: flex; margin-bottom: 20px; }
    .msg-content { max-width: 80%; padding: 12px 16px; border-radius: 12px; font-size: 15px; }
    .user-row { justify-content: flex-end; }
    .user-row .msg-content { background: #f4f4f4; color: #000; }
    .ai-row { justify-content: flex-start; }
    .ai-row .msg-content { background: #fff; border: 1px solid #e5e5e5; }

    /* è¾“å…¥æ¡†å›ºå®šåˆ°åº•éƒ¨ */
    .chat-input-wrapper { position: absolute; bottom: 30px; left: 15%; right: 15%; background: #fff; border: 1px solid #d1d1d1; border-radius: 12px; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    #questionInput { border: none; outline: none; width: 100%; resize: none; }

    .drop-zone.dragover { border: 2px dashed #10a37f; background: #f0fff4; }
  </style>
</head>
<body>

<div id="sidebar">
  <button class="sidebar-btn mt-3" onclick="createNewChat()">
    <i class="bi bi-plus-lg"></i> æ–°å»ºå¯¹è¯
  </button>

  <div class="nav-link-custom mb-2" id="nav-docs" onclick="switchToDocs()">
    <i class="bi bi-folder2-open me-2"></i> æ–‡æ¡£åº“ç®¡ç†
  </div>

  <div class="px-3 py-2 small text-muted text-uppercase" style="font-size: 11px;">å†å²è®°å½•</div>
  <div class="session-list" id="sessionListContainer"></div>

  <div class="p-3 border-top border-secondary">
    <div class="d-flex justify-content-between align-items-center">
      <span id="navUsername" class="small">Loading...</span>
      <i class="bi bi-box-arrow-right cursor-pointer" onclick="logout()"></i>
    </div>
  </div>
</div>

<div id="main">
  <div id="docs-section" class="section">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4>æˆ‘çš„æ–‡æ¡£ä»“åº“</h4>
      <div class="d-flex">
        <input type="text" id="searchInput" class="form-control me-2" placeholder="æœç´¢æ–‡ä»¶å..." onkeyup="if(event.keyCode===13) handleSearch()">
        <button class="btn btn-outline-primary me-3" onclick="handleSearch()">æœç´¢</button>
        <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#uploadModal">ä¸Šä¼ </button>
      </div>
    </div>

    <table class="table">
      <thead>
      <tr><th>æ–‡ä»¶å</th><th>ç‰ˆæœ¬</th><th>å¤§å°</th><th>ä¸Šä¼ æ—¶é—´</th><th>æ“ä½œ</th></tr>
      </thead>
      <tbody id="docTableBody"></tbody>
    </table>

    <nav>
      <ul class="pagination justify-content-center" id="paginationContainer"></ul>
    </nav>
  </div>

  <div id="chat-section" class="section active">
    <div id="message-area"></div>
    <div class="chat-input-wrapper drop-zone" id="dropZone">
      <div id="uploadPreview" class="mb-1"></div>
      <div class="d-flex align-items-end">
        <textarea id="questionInput" placeholder="è¾“å…¥é—®é¢˜..." rows="1" oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea>
        <button class="btn btn-link p-1 text-primary" onclick="handleSendMessage()">
          <i class="bi bi-arrow-up-circle-fill fs-3"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="uploadModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"><h5>æ‰¹é‡ä¸Šä¼ æ–‡æ¡£</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <input type="file" id="fileInput" class="form-control mb-3" multiple>
        <textarea id="fileDesc" class="form-control" placeholder="æ–‡æ¡£æè¿° (å¯é€‰)"></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" onclick="handleUpload()">å¼€å§‹ä¸Šä¼ </button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="js/main.js"></script>
</body>
</html>

<!--<!DOCTYPE html>-->
<!--<html lang="zh-CN">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>æ™ºèƒ½æ–‡æ¡£å¹³å° - æ§åˆ¶å°</title>-->
<!--  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--</head>-->
<!--<body>-->

<!--<nav class="navbar navbar-dark bg-primary mb-4">-->
<!--  <div class="container">-->
<!--    <span class="navbar-brand mb-0 h1">ğŸ“‚ æ™ºèƒ½æ–‡æ¡£ç®¡ç†å¹³å°</span>-->
<!--    <div class="d-flex align-items-center text-white">-->
<!--      <span id="navUsername" class="me-3">æœªç™»å½•</span>-->
<!--      <button class="btn btn-sm btn-outline-light" onclick="logout()">é€€å‡º</button>-->
<!--    </div>-->
<!--  </div>-->
<!--</nav>-->

<!--<div class="container">-->
<!--  <div class="card mb-4">-->
<!--    <div class="card-body">-->
<!--      <h5 class="card-title">ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯</h5>-->
<!--      <p class="card-text">-->
<!--        ID: <span id="userId">&#45;&#45;</span> |-->
<!--        è§’è‰²: <span id="userRole">&#45;&#45;</span> |-->
<!--        æ³¨å†Œæ—¶é—´: <span id="createdTime">&#45;&#45;</span>-->
<!--      </p>-->
<!--    </div>-->
<!--  </div>-->

<!--  <div class="card">-->
<!--    <div class="card-header d-flex justify-content-between align-items-center">-->
<!--      <h5 class="mb-0">ğŸ“„ æ–‡æ¡£åˆ—è¡¨</h5>-->
<!--      <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#uploadModal">-->
<!--        + ä¸Šä¼ æ–‡æ¡£-->
<!--      </button>-->
<!--    </div>-->
<!--    <div class="card-body">-->
<!--      <div class="row mb-3">-->
<!--        <div class="col-md-4">-->
<!--          <input type="text" id="searchInput" class="form-control" placeholder="è¾“å…¥æ–‡æ¡£åç§°æœç´¢...">-->
<!--        </div>-->
<!--        <div class="col-md-2">-->
<!--          <button class="btn btn-primary w-100" onclick="loadDocuments(1)">æœç´¢</button>-->
<!--        </div>-->
<!--      </div>-->

<!--      <table class="table table-hover">-->
<!--        <thead>-->
<!--        <tr>-->
<!--          <th>æ–‡æ¡£å</th>-->
<!--          <th>ç±»å‹</th>-->
<!--          <th>å¤§å°</th>-->
<!--          <th>ç‰ˆæœ¬</th>-->
<!--          <th>ä¸Šä¼ æ—¶é—´</th>-->
<!--          <th>æ“ä½œ</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="docTableBody">-->
<!--        </tbody>-->
<!--      </table>-->

<!--      <nav>-->
<!--        <ul class="pagination justify-content-center" id="pagination"></ul>-->
<!--      </nav>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->

<!--<div class="modal fade" id="uploadModal" tabindex="-1">-->
<!--  <div class="modal-dialog">-->
<!--    <div class="modal-content">-->
<!--      <div class="modal-header">-->
<!--        <h5 class="modal-title">ä¸Šä¼ æ–°æ–‡æ¡£ (æ”¯æŒæ‰¹é‡ä¸Šä¼ )</h5>-->
<!--        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--      </div>-->
<!--      <div class="modal-body">-->
<!--        <form id="uploadForm">-->
<!--          <div class="mb-3">-->
<!--            <label class="form-label">é€‰æ‹©æ–‡ä»¶</label>-->
<!--            <input type="file" class="form-control" id="fileInput" multiple required>-->
<!--          </div>-->
<!--          <div class="mb-3">-->
<!--            <label class="form-label">æ–‡æ¡£æè¿° (å¯¹æ‰€æœ‰æ–‡ä»¶é€šç”¨)</label>-->
<!--            <textarea class="form-control" id="fileDesc"></textarea>-->
<!--          </div>-->
<!--        </form>-->
<!--      </div>-->
<!--      <div class="modal-footer">-->
<!--        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>-->
<!--        <button type="button" class="btn btn-primary" onclick="handleUpload()">å¼€å§‹ä¸Šä¼ </button>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->

<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>-->
<!--<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>-->
<!--<script src="js/main.js"></script>-->
<!--<script>-->
<!--  // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ-->
<!--  document.addEventListener('DOMContentLoaded', () => {-->
<!--    checkAuth(); // æ£€æŸ¥Token-->
<!--    fetchUserInfo(); // è·å–ç”¨æˆ·ä¿¡æ¯-->
<!--    loadDocuments(1); // åŠ è½½æ–‡æ¡£åˆ—è¡¨-->
<!--  });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->


